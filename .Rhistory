use_package("readr")
use_package("tidyr")
use_package("dplyr")
use_package("ggplot2")
use_package("purrr")
use_mit_license()
install.packages("optparse")
use_package("optparse")
use_package("rentrez")
cleanKmerData <- function(x){
x <- x %>%
separate_rows(CIGAR, sep = " ") %>%
group_by(SEQID) %>%
mutate(order = row_number()) %>%
separate(CIGAR, into = c("taxid", "kmers")) %>%
ungroup()
x %>%
filter(taxid != 0) %>%
select(taxid) %>%
unique() %>%
rowwise(taxid) %>%
mutate(taxeng = rentrez::entrez_fetch(db = "taxonomy", id = taxid, rettype = "text"),
taxeng = stringr::str_match(taxeng, pattern = "1\\. (.*)\n"),
taxeng = taxeng[,2]) %>%
right_join(x, by = "taxid") %>%
mutate(taxeng = replace_na(taxeng, "Unclassified")) %>%
select(Status, SEQID, TAXID, Length, order, taxid, taxeng, kmers)
}
library(krakenreports)
devtools::document()
